<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
</head>
<body>
	<script>
		
		//конструктор создаёт для каждого пространства своё изолированное окружение, которое изолировано от других пространств и их переменных
		//конструктор принимает функцию обратного вызова (обертку), которая будет создавать изолированное окружение (контекст, IIFE)
		
//		В этом изолированном окружении есть бизнес-логика сайта, а этот конструктор просто подмешивает к ней модули из библиотеки Sandbox. Т.е. подмешивает какие-то свойства и методы
		
		//тут пространство создаётся через new, а дальше без. Это благодаря шаблону "самовызывающийся констуктор без new"
		new Sandbox(function (box) {
		// здесь находится ваш программный код...
		});
		
		
		//модули, которые может использовать это пространство (зависимости), могут передаваться двумя способами:
		
		//в массиве
		Sandbox(['ajax', 'event'], function (box) {
		// console.log(box);
		});
		
		//отдельными аргументами
		Sandbox('ajax', 'dom', function (box) {
		// console.log(box);
		});
		
		//звездочка = все доступные модули
		Sandbox('*', function (box) {
		// console.log(box);
		});
		
		//если модули не указаны = все доступные модули
		Sandbox(function (box) {
		// console.log(box);
		});
		
		
		//это вариант, где внутри пространства есть вложенное подпространство
		Sandbox("dom", "event", function (box) {
			// использует модули dom и event
			Sandbox("ajax", function (box) {
				// другой объект “box” изолированного пространства имен
				// этот объект “box” отличается от объекта
				// “box”, находящегося за пределами этой функции
				//...
				// конец пространства имен, использующего модуль Аjax
			});
			// здесь модуль Аjax недоступен
		});
		
		
		//Модули хранятся в свойстве конструктора
		//Это не готовые созданные модули, а функции, которые при создании модуля добавляют к нему нужные методы.
		//box - это модуль, который сейчас создаётся
		//Т.е. у нас могут быть создано 2 инстанса модуля dom?
		//Т.е. конструктор создаёт изолированное пространство и подмешивает в него методы нужных модулей
		Sandbox.modules = {};
		
		Sandbox.modules.dom = function (box) {
			box.getElement = function () {};
			box.getStyle = function () {};
			box.foo = "bar";
		};
		
		Sandbox.modules.event = function (box) {
			// при необходимости к прототипу Sandbox можно обратиться так:
			// box.constructor.prototype.m = “mmm”;
			box.attachEvent = function () {};
			box.detachEvent = function () {};
		};
		
		Sandbox.modules.ajax = function (box) {
			box.makeRequest = function () {};
			box.getResponse = function () {};
		};

	</script>
</body>
</html>